<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <title>Income Tax Calculator 2025-26 | Old vs New Regime | ITR Stats</title>
    <meta name="description" content="Free income tax calculator for FY 2025-26. Compare old vs new tax regime and find which saves you more. Includes 80C, 80D, HRA, and NPS deductions.">
    <meta name="keywords" content="income tax calculator, old vs new regime calculator, tax calculator India, FY 2025-26 tax calculator, 80C deduction calculator">
    <meta name="author" content="ITR Stats">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://itrstats.in/calculator/income-tax/">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://itrstats.in/calculator/income-tax/">
    <meta property="og:title" content="Income Tax Calculator 2025-26 | Old vs New Regime">
    <meta property="og:description" content="Compare old vs new tax regime and find which saves you more tax.">
    <meta property="og:image" content="https://itrstats.in/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="ITR Stats">
    <meta property="og:locale" content="en_IN">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Income Tax Calculator 2025-26 | Old vs New Regime">
    <meta name="twitter:description" content="Compare old vs new tax regime and find which saves you more tax.">
    <meta name="twitter:image" content="https://itrstats.in/og-image.png">

    <link rel="icon" type="image/png" href="/favicon.png">

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2843260079810330"
        crossorigin="anonymous"></script>

    <!-- Structured Data - WebApplication -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Income Tax Calculator 2025-26",
        "description": "Free online income tax calculator to compare old vs new tax regime for FY 2025-26. Calculate tax with deductions like 80C, 80D, HRA, NPS.",
        "url": "https://itrstats.in/calculator/income-tax/",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "INR"
        },
        "author": {
            "@type": "Organization",
            "name": "ITR Stats",
            "url": "https://itrstats.in"
        }
    }
    </script>

    <!-- Structured Data - FAQ -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "Which is better: Old or New tax regime?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "For FY 2025-26, the new regime is beneficial for most taxpayers due to revised slabs and ‚Çπ12L rebate limit. Old regime may be better only if you have very high deductions (80C, 80D, HRA, home loan) exceeding ‚Çπ4-5 lakhs combined."
                }
            },
            {
                "@type": "Question",
                "name": "What is the standard deduction in new tax regime?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "The standard deduction in the new tax regime is ‚Çπ75,000 for FY 2025-26 (increased from ‚Çπ50,000 in Budget 2024). In the old regime, it remains ‚Çπ50,000."
                }
            },
            {
                "@type": "Question",
                "name": "Is there tax rebate in new regime?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, under Section 87A for FY 2025-26, if your taxable income is up to ‚Çπ12,00,000 in the new regime, you get a full tax rebate and pay zero tax."
                }
            },
            {
                "@type": "Question",
                "name": "What is the exemption limit for senior citizens?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "In the old tax regime, senior citizens (60-80 years) have an exemption limit of ‚Çπ3L, and super senior citizens (80+) have ‚Çπ5L. In the new regime, the slabs are the same for all ages."
                }
            },
            {
                "@type": "Question",
                "name": "When is surcharge applicable?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Surcharge applies on tax for high-income earners: 10% for income ‚Çπ50L-1Cr, 15% for ‚Çπ1-2Cr, 25% for ‚Çπ2-5Cr, and 37% (old regime) or 25% (new regime) for above ‚Çπ5Cr."
                }
            },
            {
                "@type": "Question",
                "name": "What is marginal relief in income tax?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Marginal relief ensures that if your income slightly exceeds a threshold (rebate limit or surcharge slab), your tax doesn't exceed the extra income earned. For example, in new regime at ‚Çπ12,00,100 taxable income, tax is capped at ‚Çπ100. Similarly, at ‚Çπ50,00,100, surcharge marginal relief ensures you don't pay significantly more than someone earning exactly ‚Çπ50L."
                }
            },
            {
                "@type": "Question",
                "name": "What is 80CCD(2) employer NPS contribution?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Section 80CCD(2) allows deduction for employer's contribution to your NPS account, up to 10% of your basic salary (14% for central govt employees). This is over and above the ‚Çπ1.5L limit under 80C and ‚Çπ50K under 80CCD(1B)."
                }
            }
        ]
    }
    </script>

    <!-- Structured Data - Breadcrumb -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://itrstats.in/"},
            {"@type": "ListItem", "position": 2, "name": "Calculators", "item": "https://itrstats.in/calculator/"},
            {"@type": "ListItem", "position": 3, "name": "Income Tax Calculator", "item": "https://itrstats.in/calculator/income-tax/"}
        ]
    }
    </script>

    <style>
        /* Light mode (default) */
        :root {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-accent: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --accent-blue: #3b82f6;
            --accent-green: #22c55e;
            --accent-red: #ef4444;
            --border-color: #e2e8f0;
        }

        /* Dark mode */
        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-accent: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --accent-blue: #60a5fa;
            --accent-green: #4ade80;
            --accent-red: #f87171;
            --border-color: #334155;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 1rem;
            line-height: 1.6;
        }

        .wrapper {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-radius: 16px;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header-left h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        .header-left p {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-link {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            transition: color 0.2s ease, background 0.2s ease;
        }

        .header-link:hover {
            color: var(--accent-blue);
            background: var(--bg-accent);
        }

        .header-link.active {
            color: var(--accent-blue);
        }

        .new-badge {
            display: inline-block;
            margin-left: 0.35rem;
            padding: 0.1rem 0.35rem;
            border-radius: 999px;
            background: #ef4444;
            color: #ffffff;
            font-size: 0.62rem;
            font-weight: 700;
            line-height: 1.2;
            vertical-align: middle;
            animation: blinkTag 1s steps(2, start) infinite;
        }

        @keyframes blinkTag {
            50% {
                opacity: 0.2;
            }
        }

        .theme-toggle {
            background: var(--bg-accent);
            border: none;
            border-radius: 12px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .container {
            padding: 0;
        }

        h1 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .subtitle {
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .input-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .input-section h2 {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .input-group {
            margin-bottom: 1.25rem;
        }

        .input-group label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .input-group .hint {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .input-wrapper {
            position: relative;
        }

        .input-wrapper .prefix {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        input[type="number"],
        select {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--bg-accent);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }

        input[type="number"] {
            padding-left: 2.25rem;
        }

        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23718096' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
        }

        [data-theme="dark"] select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2394a3b8' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
        }

        select option {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        input[type="number"]::placeholder {
            color: var(--text-muted);
        }

        /* Hide number input arrows */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }

        .result-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .result-section h2 {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        .regime-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .regime-card {
            background: var(--bg-accent);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            border: 2px solid transparent;
            transition: border-color 0.2s ease;
        }

        .regime-card.winner {
            border-color: var(--accent-green);
        }

        .regime-card .label {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .regime-card .tax-amount {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .regime-card.winner .tax-amount {
            color: var(--accent-green);
        }

        .regime-card .effective-rate {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .savings-box {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.1), rgba(74, 222, 128, 0.05));
            border: 1px solid var(--accent-green);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .savings-box .icon {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .savings-box .text {
            color: var(--accent-green);
            font-weight: 600;
        }

        .savings-box .amount {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-green);
        }

        .takehome-section {
            margin-bottom: 1.5rem;
        }

        .takehome-section h3 {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
            text-align: center;
        }

        .takehome-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .takehome-card {
            background: var(--bg-accent);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
        }

        .takehome-card .label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.375rem;
        }

        .takehome-card .yearly {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .takehome-card .monthly {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.125rem;
        }

        .breakdown-toggle {
            background: none;
            border: none;
            color: var(--accent-blue);
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0 auto;
        }

        .breakdown-toggle:hover {
            text-decoration: underline;
        }

        .breakdown {
            display: none;
            margin-top: 1.5rem;
        }

        .breakdown.show {
            display: block;
        }

        .breakdown-section {
            margin-bottom: 1.5rem;
        }

        .breakdown-section h3 {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .breakdown-table {
            width: 100%;
            font-size: 0.9rem;
        }

        .breakdown-table tr {
            border-bottom: 1px solid var(--border-color);
        }

        .breakdown-table td {
            padding: 0.625rem 0;
            color: var(--text-secondary);
        }

        .breakdown-table td:last-child {
            text-align: right;
            font-family: 'SF Mono', 'Consolas', monospace;
        }

        .breakdown-table tr.total {
            border-bottom: none;
        }

        .breakdown-table tr.total td {
            font-weight: 600;
            color: var(--text-primary);
            padding-top: 0.75rem;
        }

        .breakdown-table .deduction {
            color: var(--accent-green);
        }

        .content-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 1.5rem;
        }

        .content-section h2 {
            font-size: 1.25rem;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }

        .content-section p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .content-section ul {
            color: var(--text-secondary);
            margin-left: 1.25rem;
            margin-bottom: 1rem;
        }

        .content-section li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        .tax-slab-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .tax-slab-table th,
        .tax-slab-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .tax-slab-table th {
            background: var(--bg-accent);
            font-weight: 600;
            color: var(--text-primary);
        }

        .tax-slab-table td {
            color: var(--text-secondary);
        }

        .faq-section {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 1.5rem;
        }

        .faq-section h2 {
            font-size: 1.25rem;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
        }

        .faq-item {
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
        }

        .faq-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .faq-item:first-of-type {
            padding-top: 0;
        }

        .faq-question {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .faq-answer {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
            font-size: 0.85rem;
            border-top: 1px solid var(--border-color);
            margin-top: 2rem;
        }

        footer a {
            color: var(--accent-blue);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--text-muted);
            color: var(--bg-secondary);
            font-size: 0.5rem;
            font-weight: 700;
            cursor: pointer;
            margin-left: 0.25rem;
            vertical-align: middle;
            position: relative;
        }

        .info-icon:hover { background: var(--accent-blue); }

        .info-tooltip {
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-primary);
            color: var(--bg-primary);
            padding: 0.6rem 0.8rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 400;
            width: 200px;
            text-align: left;
            line-height: 1.4;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease;
            z-index: 100;
        }

        .info-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: var(--text-primary);
        }

        .info-icon:hover .info-tooltip { opacity: 1; visibility: visible; }

        .footer-creator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .footer-creator a {
            color: var(--text-muted);
            display: inline-flex;
            transition: color 0.2s ease;
        }

        .footer-creator a:hover {
            color: var(--accent-blue);
        }

        .footer-feedback {
            font-size: 0.8rem;
            margin-bottom: 0.75rem;
        }

        .footer-legal {
            font-size: 0.8rem;
        }

        .footer-legal a {
            color: var(--text-muted);
            text-decoration: none;
        }

        .footer-legal a:hover {
            color: var(--accent-blue);
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: 0.75rem;
            }

            .calculator-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 0.75rem;
                text-align: center;
            }

            .header-right {
                flex-wrap: wrap;
                justify-content: center;
                gap: 0.5rem;
            }

            .header-link {
                font-size: 0.8rem;
                padding: 0.4rem 0.6rem;
            }

            .regime-card .tax-amount {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 480px) {
            .input-section,
            .result-section {
                padding: 1.25rem;
            }

            .regime-comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <header class="header">
            <div class="header-left">
                <h1>Income Tax Calculator</h1>
                <p>FY 2025-26</p>
            </div>
            <div class="header-right">
                <a href="/" class="header-link">Dashboard</a>
                <a href="/insights/" class="header-link">Insights <span class="new-badge">NEW</span></a>
                <a href="/blog/" class="header-link">Blog</a>
                <a href="/calculator/" class="header-link active">Calculator</a>
                <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
                    <span id="theme-icon"></span>
                </button>
            </div>
        </header>

        <main class="container">
            <div class="calculator-grid">
            <div class="input-section">
                <h2>üìù Your Income & Deductions</h2>

                <div class="input-group">
                    <label for="age">Age Group</label>
                    <select id="age">
                        <option value="general">Below 60 years</option>
                        <option value="senior">60-80 years (Senior Citizen)</option>
                        <option value="supersenior">80+ years (Super Senior)</option>
                    </select>
                    <p class="hint">Affects old regime exemption limit</p>
                </div>

                <div class="input-group">
                    <label for="income">Annual Income (Gross Salary)</label>
                    <div class="input-wrapper">
                        <span class="prefix">‚Çπ</span>
                        <input type="number" id="income" placeholder="e.g. 1200000" min="0">
                    </div>
                </div>

                <div class="input-group">
                    <label for="deduction80c">80C Investments</label>
                    <div class="input-wrapper">
                        <span class="prefix">‚Çπ</span>
                        <input type="number" id="deduction80c" placeholder="0" min="0" max="150000">
                    </div>
                    <p class="hint">PPF, ELSS, LIC, PF, etc. (Max ‚Çπ1,50,000)</p>
                </div>

                <div class="input-group">
                    <label for="deduction80d">80D Health Insurance</label>
                    <div class="input-wrapper">
                        <span class="prefix">‚Çπ</span>
                        <input type="number" id="deduction80d" placeholder="0" min="0" max="100000">
                    </div>
                    <p class="hint">Self ‚Çπ25K (‚Çπ50K if senior) + Parents ‚Çπ25K (‚Çπ50K if senior). Max ‚Çπ1L</p>
                </div>

                <div class="input-group">
                    <label for="hra">HRA Exemption Claimed</label>
                    <div class="input-wrapper">
                        <span class="prefix">‚Çπ</span>
                        <input type="number" id="hra" placeholder="0" min="0">
                    </div>
                    <p class="hint">Leave blank if you don't claim HRA</p>
                    <p class="hint warning" id="hra-warning" style="display: none; color: var(--accent-red);">HRA seems high. Typically limited to 40-50% of basic salary.</p>
                </div>

                <div class="input-group">
                    <label for="homeloan">Home Loan Interest (Sec 24)</label>
                    <div class="input-wrapper">
                        <span class="prefix">‚Çπ</span>
                        <input type="number" id="homeloan" placeholder="0" min="0" max="200000">
                    </div>
                    <p class="hint">Interest on housing loan (Max ‚Çπ2,00,000)</p>
                </div>

                <div class="input-group">
                    <label for="nps">NPS Contribution 80CCD(1B)</label>
                    <div class="input-wrapper">
                        <span class="prefix">‚Çπ</span>
                        <input type="number" id="nps" placeholder="0" min="0" max="50000">
                    </div>
                    <p class="hint">Your NPS contribution (Max ‚Çπ50,000)</p>
                </div>

                <div class="input-group">
                    <label for="nps_employer">Employer NPS 80CCD(2)</label>
                    <div class="input-wrapper">
                        <span class="prefix">‚Çπ</span>
                        <input type="number" id="nps_employer" placeholder="0" min="0">
                    </div>
                    <p class="hint">Employer's NPS contribution (Max 10% of basic salary)</p>
                </div>
            </div>

            <div class="result-section">
                <h2>üí∞ Your Tax Comparison</h2>

                <div class="regime-comparison">
                    <div class="regime-card" id="old-regime-card">
                        <div class="label">Old Regime</div>
                        <div class="tax-amount" id="old-tax">‚Çπ0</div>
                        <div class="effective-rate" id="old-rate">0% effective</div>
                    </div>
                    <div class="regime-card" id="new-regime-card">
                        <div class="label">New Regime</div>
                        <div class="tax-amount" id="new-tax">‚Çπ0</div>
                        <div class="effective-rate" id="new-rate">0% effective</div>
                    </div>
                </div>

                <div class="savings-box" id="savings-box">
                    <div class="icon">‚úì</div>
                    <div class="text">Enter your income to see comparison</div>
                </div>

                <div class="takehome-section" id="takehome-section" style="display: none;">
                    <h3>Your Take-Home Salary</h3>
                    <div class="takehome-comparison">
                        <div class="takehome-card">
                            <div class="label">Old Regime</div>
                            <div class="yearly" id="old-yearly">‚Çπ0/year</div>
                            <div class="monthly" id="old-monthly">‚Çπ0/month</div>
                        </div>
                        <div class="takehome-card">
                            <div class="label">New Regime</div>
                            <div class="yearly" id="new-yearly">‚Çπ0/year</div>
                            <div class="monthly" id="new-monthly">‚Çπ0/month</div>
                        </div>
                    </div>
                </div>

                <button class="breakdown-toggle" onclick="toggleBreakdown()">
                    Show detailed breakdown ‚ñº
                </button>

                <div class="breakdown" id="breakdown">
                    <div class="breakdown-section">
                        <h3>Old Regime Calculation</h3>
                        <table class="breakdown-table" id="old-breakdown">
                            <tr><td>Gross Income</td><td>‚Çπ0</td></tr>
                        </table>
                    </div>

                    <div class="breakdown-section">
                        <h3>New Regime Calculation</h3>
                        <table class="breakdown-table" id="new-breakdown">
                            <tr><td>Gross Income</td><td>‚Çπ0</td></tr>
                        </table>
                    </div>
                </div>

                <p style="font-size: 0.75rem; color: var(--text-muted); text-align: center; margin-top: 1.5rem; padding: 0.75rem; background: var(--bg-accent); border-radius: 8px;">
                    ‚ö†Ô∏è This calculator is for estimation purposes only. Please consult a tax professional for accurate advice.
                </p>
            </div>
        </div>
        </main>

        <section class="content-section">
            <h2>Income Tax Slabs for FY 2025-26</h2>
            <p>India offers two tax regimes - the Old Regime with deductions and the New Regime with lower rates but fewer deductions. Here's a comparison:</p>

            <h3 style="font-size: 1.1rem; margin-top: 1.5rem; margin-bottom: 0.75rem;">New Tax Regime (Default)</h3>
            <table class="tax-slab-table">
                <thead>
                    <tr>
                        <th>Income Slab</th>
                        <th>Tax Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Up to ‚Çπ4,00,000</td><td>Nil</td></tr>
                    <tr><td>‚Çπ4,00,001 - ‚Çπ8,00,000</td><td>5%</td></tr>
                    <tr><td>‚Çπ8,00,001 - ‚Çπ12,00,000</td><td>10%</td></tr>
                    <tr><td>‚Çπ12,00,001 - ‚Çπ16,00,000</td><td>15%</td></tr>
                    <tr><td>‚Çπ16,00,001 - ‚Çπ20,00,000</td><td>20%</td></tr>
                    <tr><td>‚Çπ20,00,001 - ‚Çπ24,00,000</td><td>25%</td></tr>
                    <tr><td>Above ‚Çπ24,00,000</td><td>30%</td></tr>
                </tbody>
            </table>
            <p style="font-size: 0.85rem; color: var(--text-muted);">Standard deduction: ‚Çπ75,000 | Rebate u/s 87A: Full tax rebate if taxable income ‚â§ ‚Çπ12,00,000</p>

            <h3 style="font-size: 1.1rem; margin-top: 1.5rem; margin-bottom: 0.75rem;">Old Tax Regime</h3>
            <table class="tax-slab-table">
                <thead>
                    <tr>
                        <th>Income Slab</th>
                        <th>Tax Rate</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Up to ‚Çπ2,50,000</td><td>Nil</td></tr>
                    <tr><td>‚Çπ2,50,001 - ‚Çπ5,00,000</td><td>5%</td></tr>
                    <tr><td>‚Çπ5,00,001 - ‚Çπ10,00,000</td><td>20%</td></tr>
                    <tr><td>Above ‚Çπ10,00,000</td><td>30%</td></tr>
                </tbody>
            </table>
            <p style="font-size: 0.85rem; color: var(--text-muted);">Standard deduction: ‚Çπ50,000 | Rebate u/s 87A: Up to ‚Çπ12,500 if taxable income ‚â§ ‚Çπ5,00,000</p>
        </section>

        <section class="content-section">
            <h2>Key Deductions (Old Regime Only)</h2>
            <ul>
                <li><strong>Section 80C (Max ‚Çπ1.5L):</strong> PPF, ELSS, LIC premium, EPF, home loan principal, tuition fees, NSC, tax-saver FDs</li>
                <li><strong>Section 80D (Max ‚Çπ1L):</strong> Health insurance premium - ‚Çπ25K for self/family (‚Çπ50K if senior citizen) + ‚Çπ25K for parents (‚Çπ50K if senior)</li>
                <li><strong>Section 80CCD(1B) (Max ‚Çπ50K):</strong> Additional NPS contribution beyond 80C limit</li>
                <li><strong>Section 80CCD(2):</strong> Employer's NPS contribution (up to 10% of basic salary)</li>
                <li><strong>Section 24 (Max ‚Çπ2L):</strong> Home loan interest for self-occupied property</li>
                <li><strong>HRA Exemption:</strong> Based on actual HRA received, rent paid, and city of residence</li>
            </ul>
        </section>

        <section class="content-section">
            <h2>Surcharge and Cess</h2>
            <p>In addition to the base tax, high-income earners pay surcharge, and everyone pays Health & Education Cess:</p>
            <ul>
                <li><strong>Surcharge:</strong> 10% (‚Çπ50L-1Cr), 15% (‚Çπ1-2Cr), 25% (‚Çπ2-5Cr), 37%/25% (above ‚Çπ5Cr for old/new regime)</li>
                <li><strong>Health & Education Cess:</strong> 4% on (Tax + Surcharge)</li>
                <li><strong>Marginal Relief:</strong> If your income just crosses a threshold, tax is capped so you don't pay more than the excess income</li>
            </ul>
        </section>

        <section class="faq-section">
            <h2>Frequently Asked Questions</h2>

            <div class="faq-item">
                <div class="faq-question">Which tax regime is better - Old or New?</div>
                <div class="faq-answer">For FY 2025-26, the new regime is better for most taxpayers due to lower rates and ‚Çπ12L rebate limit. Old regime may be better only if your total deductions (80C, 80D, HRA, home loan interest) exceed ‚Çπ4-5 lakhs.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">What is the standard deduction?</div>
                <div class="faq-answer">Standard deduction is a flat deduction from salary income. It's ‚Çπ75,000 in the new regime (FY 2025-26) and ‚Çπ50,000 in the old regime. No bills or proof required.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">What is the rebate under Section 87A?</div>
                <div class="faq-answer">In the new regime, if your taxable income is up to ‚Çπ12,00,000, you get a full rebate and pay zero tax. In the old regime, the rebate is up to ‚Çπ12,500 if taxable income is up to ‚Çπ5,00,000.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">What is marginal relief?</div>
                <div class="faq-answer">Marginal relief ensures that if your income slightly exceeds a threshold (like ‚Çπ12L for rebate or ‚Çπ50L for surcharge), your total tax doesn't exceed the excess income. This prevents unfair taxation at threshold crossings.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Can I switch between old and new regime?</div>
                <div class="faq-answer">Salaried employees can switch regimes every year while filing ITR. Business owners can switch only once in their lifetime. The new regime is the default from FY 2023-24.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Is NPS contribution allowed in new regime?</div>
                <div class="faq-answer">Yes, employer's NPS contribution under Section 80CCD(2) is allowed in both regimes. However, your own NPS contribution under 80CCD(1B) is only allowed in the old regime.</div>
            </div>
        </section>
    </div>

    <footer>
        <p class="footer-creator">
            <strong>Built by Kartikey</strong>
            <a href="https://x.com/kartikey_19" target="_blank" rel="noopener" aria-label="Twitter">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
            <a href="https://www.linkedin.com/in/kartikeyrajvaidya/" target="_blank" rel="noopener" aria-label="LinkedIn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
        </p>
        <p class="footer-feedback">Open to feedback!</p>
        <p class="footer-legal">¬© 2026 ITR Stats ¬∑ <a href="/privacy-policy.html">Privacy</a> ¬∑ <a href="https://eportal.incometax.gov.in" target="_blank" rel="noopener">Data Source</a>
            <span class="info-icon">i<span class="info-tooltip">Unofficial dashboard ¬∑ Not affiliated with Income Tax Department</span></span>
        </p>
    </footer>

    <!-- GoatCounter Analytics -->
    <script data-goatcounter="https://itrstats.goatcounter.com/count"
            async src="https://gc.zgo.at/count.js"></script>

    <script>
        // Theme functions
        function getThemePreference() {
            const saved = localStorage.getItem('theme');
            if (saved) return saved;
            return 'dark';
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            document.getElementById('theme-icon').textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            setTheme(current === 'dark' ? 'light' : 'dark');
        }

        // Initialize theme
        setTheme(getThemePreference());

        // Tax slabs FY 2025-26 - Old Regime (varies by age)
        const OLD_SLABS_GENERAL = [
            { limit: 250000, rate: 0 },      // 0-2.5L: 0%
            { limit: 500000, rate: 0.05 },   // 2.5-5L: 5%
            { limit: 1000000, rate: 0.20 },  // 5-10L: 20%
            { limit: Infinity, rate: 0.30 }  // 10L+: 30%
        ];

        const OLD_SLABS_SENIOR = [
            { limit: 300000, rate: 0 },      // 0-3L: 0% (Senior Citizen)
            { limit: 500000, rate: 0.05 },   // 3-5L: 5%
            { limit: 1000000, rate: 0.20 },  // 5-10L: 20%
            { limit: Infinity, rate: 0.30 }  // 10L+: 30%
        ];

        const OLD_SLABS_SUPERSENIOR = [
            { limit: 500000, rate: 0 },      // 0-5L: 0% (Super Senior)
            { limit: 1000000, rate: 0.20 },  // 5-10L: 20%
            { limit: Infinity, rate: 0.30 }  // 10L+: 30%
        ];

        // FY 2025-26 New Regime Slabs (Budget 2025) - Same for all ages
        const NEW_SLABS = [
            { limit: 400000, rate: 0 },      // 0-4L: 0%
            { limit: 800000, rate: 0.05 },   // 4-8L: 5%
            { limit: 1200000, rate: 0.10 },  // 8-12L: 10%
            { limit: 1600000, rate: 0.15 },  // 12-16L: 15%
            { limit: 2000000, rate: 0.20 },  // 16-20L: 20%
            { limit: 2400000, rate: 0.25 },  // 20-24L: 25%
            { limit: Infinity, rate: 0.30 }  // 24L+: 30%
        ];

        const OLD_STANDARD_DEDUCTION = 50000;
        const NEW_STANDARD_DEDUCTION = 75000;
        const CESS_RATE = 0.04;
        const NEW_REGIME_REBATE_LIMIT = 1200000; // ‚Çπ12L rebate limit (FY 2025-26)

        // Get old regime slabs based on age
        function getOldSlabs(ageGroup) {
            switch (ageGroup) {
                case 'senior': return OLD_SLABS_SENIOR;
                case 'supersenior': return OLD_SLABS_SUPERSENIOR;
                default: return OLD_SLABS_GENERAL;
            }
        }

        // Surcharge thresholds
        const SURCHARGE_THRESHOLDS = [5000000, 10000000, 20000000, 50000000];

        // Calculate surcharge based on taxable income
        function calculateSurcharge(tax, taxableIncome, isNewRegime) {
            if (taxableIncome <= 5000000) return 0;
            if (taxableIncome <= 10000000) return tax * 0.10;
            if (taxableIncome <= 20000000) return tax * 0.15;
            if (taxableIncome <= 50000000) return tax * 0.25;
            return tax * (isNewRegime ? 0.25 : 0.37);
        }

        // Get surcharge rate for a given taxable income
        function getSurchargeRate(taxableIncome, isNewRegime) {
            if (taxableIncome <= 5000000) return 0;
            if (taxableIncome <= 10000000) return 0.10;
            if (taxableIncome <= 20000000) return 0.15;
            if (taxableIncome <= 50000000) return 0.25;
            return isNewRegime ? 0.25 : 0.37;
        }

        // Calculate total tax at a specific income level (for surcharge marginal relief)
        function calculateTotalTaxAtIncome(taxableIncome, slabs, isNewRegime) {
            let tax = calculateSlabTax(taxableIncome, slabs);
            const surchargeRate = getSurchargeRate(taxableIncome, isNewRegime);
            const surcharge = tax * surchargeRate;
            const cess = (tax + surcharge) * CESS_RATE;
            return tax + surcharge + cess;
        }

        // Calculate surcharge marginal relief at threshold crossings
        function calculateSurchargeMarginalRelief(taxableIncome, baseTax, surcharge, cess, slabs, isNewRegime) {
            const totalTax = baseTax + surcharge + cess;
            let relief = 0;

            for (const threshold of SURCHARGE_THRESHOLDS) {
                // Only check if income just crossed this threshold
                if (taxableIncome > threshold) {
                    const excessIncome = taxableIncome - threshold;
                    const taxAtThreshold = calculateTotalTaxAtIncome(threshold, slabs, isNewRegime);
                    const maxAllowedTax = taxAtThreshold + excessIncome;

                    if (totalTax > maxAllowedTax) {
                        relief = Math.max(relief, totalTax - maxAllowedTax);
                    }
                }
            }

            return relief;
        }

        // Format currency
        function formatCurrency(amount) {
            return '‚Çπ' + Math.round(amount).toLocaleString('en-IN');
        }

        // Calculate tax based on slabs
        function calculateSlabTax(income, slabs) {
            let tax = 0;
            let remaining = income;
            let prevLimit = 0;

            for (const slab of slabs) {
                if (remaining <= 0) break;
                const taxableInSlab = Math.min(remaining, slab.limit - prevLimit);
                tax += taxableInSlab * slab.rate;
                remaining -= taxableInSlab;
                prevLimit = slab.limit;
            }

            return tax;
        }

        // Old Regime rebate limit
        const OLD_REGIME_REBATE_LIMIT = 500000;

        // Calculate tax for Old Regime
        function calculateOldRegimeTax(income, deductions, ageGroup) {
            const { sec80c, sec80d, hra, homeLoan, nps, npsEmployer } = deductions;

            // Apply deductions
            let taxableIncome = income;
            taxableIncome -= OLD_STANDARD_DEDUCTION;
            taxableIncome -= Math.min(sec80c, 150000);
            taxableIncome -= Math.min(sec80d, 100000);
            taxableIncome -= hra;
            taxableIncome -= Math.min(homeLoan, 200000);
            taxableIncome -= Math.min(nps, 50000);
            // 80CCD(2) - employer NPS contribution (no fixed limit, user enters calculated amount)
            taxableIncome -= npsEmployer;
            taxableIncome = Math.max(0, taxableIncome);

            // Get age-appropriate slabs
            const slabs = getOldSlabs(ageGroup);

            // Calculate tax
            let tax = calculateSlabTax(taxableIncome, slabs);
            let marginalRelief = 0;

            // Rebate u/s 87A (old regime: up to 5L taxable income, max rebate ‚Çπ12,500)
            if (taxableIncome <= OLD_REGIME_REBATE_LIMIT) {
                tax = Math.max(0, tax - 12500);
            } else {
                // Apply marginal relief for income just above ‚Çπ5L
                // Tax should not exceed: (taxable - 5L) + tax at 5L after rebate
                // Tax at 5L = ‚Çπ12,500, rebate = ‚Çπ12,500, so net = ‚Çπ0
                const excessIncome = taxableIncome - OLD_REGIME_REBATE_LIMIT;
                const taxWithCess = tax * (1 + CESS_RATE);
                
                if (taxWithCess > excessIncome) {
                    // Apply marginal relief - limit total tax to excess income
                    marginalRelief = taxWithCess - excessIncome;
                    tax = excessIncome / (1 + CESS_RATE); // Back-calculate base tax
                }
            }

            // Calculate surcharge
            const surcharge = calculateSurcharge(tax, taxableIncome, false);
            const taxAfterSurcharge = tax + surcharge;

            // Add cess (on tax + surcharge)
            const cess = taxAfterSurcharge * CESS_RATE;
            let totalTax = taxAfterSurcharge + cess;

            // Apply rebate marginal relief if needed
            if (marginalRelief > 0) {
                const excessIncome = taxableIncome - OLD_REGIME_REBATE_LIMIT;
                totalTax = Math.min(totalTax, excessIncome);
            }

            // Calculate surcharge marginal relief (for income just above ‚Çπ50L/1Cr/2Cr/5Cr)
            let surchargeMarginalRelief = 0;
            if (taxableIncome > 5000000 && marginalRelief === 0) {
                surchargeMarginalRelief = calculateSurchargeMarginalRelief(
                    taxableIncome, tax, surcharge, cess, slabs, false
                );
                if (surchargeMarginalRelief > 0) {
                    totalTax -= surchargeMarginalRelief;
                }
            }

            return {
                grossIncome: income,
                standardDeduction: OLD_STANDARD_DEDUCTION,
                sec80c: Math.min(sec80c, 150000),
                sec80d: Math.min(sec80d, 100000),
                hra: hra,
                homeLoan: Math.min(homeLoan, 200000),
                nps: Math.min(nps, 50000),
                npsEmployer: npsEmployer,
                taxableIncome,
                taxBeforeSurcharge: tax,
                surcharge,
                cess,
                marginalRelief,
                surchargeMarginalRelief,
                totalTax
            };
        }

        // Calculate tax for New Regime
        function calculateNewRegimeTax(income) {
            // Only standard deduction in new regime
            let taxableIncome = income - NEW_STANDARD_DEDUCTION;
            taxableIncome = Math.max(0, taxableIncome);

            // Calculate tax
            let tax = calculateSlabTax(taxableIncome, NEW_SLABS);
            let marginalRelief = 0;

            // Rebate u/s 87A (new regime: up to ‚Çπ12L taxable income)
            if (taxableIncome <= NEW_REGIME_REBATE_LIMIT) {
                tax = 0;
            } else {
                // Apply marginal relief for income just above ‚Çπ12L
                // Since rebate gives ‚Çπ0 tax at ‚Çπ12L, total tax should not exceed (taxable - ‚Çπ12L)
                const excessIncome = taxableIncome - NEW_REGIME_REBATE_LIMIT;
                const taxWithCess = tax * (1 + CESS_RATE);
                
                if (taxWithCess > excessIncome) {
                    marginalRelief = taxWithCess - excessIncome;
                }
            }

            // Calculate surcharge
            const surcharge = calculateSurcharge(tax, taxableIncome, true);
            const taxAfterSurcharge = tax + surcharge;

            // Add cess (on tax + surcharge)
            const cess = taxAfterSurcharge * CESS_RATE;
            let totalTax = taxAfterSurcharge + cess;

            // Apply rebate marginal relief - limit total tax to excess income
            if (marginalRelief > 0) {
                const excessIncome = taxableIncome - NEW_REGIME_REBATE_LIMIT;
                totalTax = Math.min(totalTax, excessIncome);
            }

            // Calculate surcharge marginal relief (for income just above ‚Çπ50L/1Cr/2Cr/5Cr)
            let surchargeMarginalRelief = 0;
            if (taxableIncome > 5000000 && marginalRelief === 0) {
                surchargeMarginalRelief = calculateSurchargeMarginalRelief(
                    taxableIncome, tax, surcharge, cess, NEW_SLABS, true
                );
                if (surchargeMarginalRelief > 0) {
                    totalTax -= surchargeMarginalRelief;
                }
            }

            return {
                grossIncome: income,
                standardDeduction: NEW_STANDARD_DEDUCTION,
                taxableIncome,
                taxBeforeSurcharge: tax,
                surcharge,
                cess,
                marginalRelief,
                surchargeMarginalRelief,
                totalTax
            };
        }

        // Generate breakdown HTML
        function generateOldBreakdown(result) {
            const deductions = [];
            deductions.push(`<tr><td>Gross Income</td><td>${formatCurrency(result.grossIncome)}</td></tr>`);
            deductions.push(`<tr><td>Standard Deduction</td><td class="deduction">- ${formatCurrency(result.standardDeduction)}</td></tr>`);
            
            if (result.sec80c > 0) {
                deductions.push(`<tr><td>80C Investments</td><td class="deduction">- ${formatCurrency(result.sec80c)}</td></tr>`);
            }
            if (result.sec80d > 0) {
                deductions.push(`<tr><td>80D Health Insurance</td><td class="deduction">- ${formatCurrency(result.sec80d)}</td></tr>`);
            }
            if (result.hra > 0) {
                deductions.push(`<tr><td>HRA Exemption</td><td class="deduction">- ${formatCurrency(result.hra)}</td></tr>`);
            }
            if (result.homeLoan > 0) {
                deductions.push(`<tr><td>Home Loan Interest</td><td class="deduction">- ${formatCurrency(result.homeLoan)}</td></tr>`);
            }
            if (result.nps > 0) {
                deductions.push(`<tr><td>NPS 80CCD(1B)</td><td class="deduction">- ${formatCurrency(result.nps)}</td></tr>`);
            }
            if (result.npsEmployer > 0) {
                deductions.push(`<tr><td>Employer NPS 80CCD(2)</td><td class="deduction">- ${formatCurrency(result.npsEmployer)}</td></tr>`);
            }

            deductions.push(`<tr class="total"><td>Taxable Income</td><td>${formatCurrency(result.taxableIncome)}</td></tr>`);
            deductions.push(`<tr><td>Tax on Income</td><td>${formatCurrency(result.taxBeforeSurcharge)}</td></tr>`);
            if (result.surcharge > 0) {
                deductions.push(`<tr><td>Surcharge</td><td>${formatCurrency(result.surcharge)}</td></tr>`);
            }
            deductions.push(`<tr><td>Health & Education Cess (4%)</td><td>${formatCurrency(result.cess)}</td></tr>`);
            if (result.marginalRelief > 0) {
                deductions.push(`<tr><td>Marginal Relief (Rebate)</td><td class="deduction">- ${formatCurrency(result.marginalRelief)}</td></tr>`);
            }
            if (result.surchargeMarginalRelief > 0) {
                deductions.push(`<tr><td>Marginal Relief (Surcharge)</td><td class="deduction">- ${formatCurrency(result.surchargeMarginalRelief)}</td></tr>`);
            }
            deductions.push(`<tr class="total"><td>Total Tax Payable</td><td>${formatCurrency(result.totalTax)}</td></tr>`);

            return deductions.join('');
        }

        function generateNewBreakdown(result) {
            const rows = [];
            rows.push(`<tr><td>Gross Income</td><td>${formatCurrency(result.grossIncome)}</td></tr>`);
            rows.push(`<tr><td>Standard Deduction</td><td class="deduction">- ${formatCurrency(result.standardDeduction)}</td></tr>`);
            rows.push(`<tr class="total"><td>Taxable Income</td><td>${formatCurrency(result.taxableIncome)}</td></tr>`);
            
            if (result.taxableIncome <= NEW_REGIME_REBATE_LIMIT && result.taxableIncome > 0) {
                rows.push(`<tr><td>Tax Before Rebate</td><td>${formatCurrency(calculateSlabTax(result.taxableIncome, NEW_SLABS))}</td></tr>`);
                rows.push(`<tr><td>Rebate u/s 87A</td><td class="deduction">- Full rebate</td></tr>`);
            }
            
            rows.push(`<tr><td>Tax on Income</td><td>${formatCurrency(result.taxBeforeSurcharge)}</td></tr>`);
            if (result.surcharge > 0) {
                rows.push(`<tr><td>Surcharge</td><td>${formatCurrency(result.surcharge)}</td></tr>`);
            }
            rows.push(`<tr><td>Health & Education Cess (4%)</td><td>${formatCurrency(result.cess)}</td></tr>`);
            if (result.marginalRelief > 0) {
                rows.push(`<tr><td>Marginal Relief (Rebate)</td><td class="deduction">- ${formatCurrency(result.marginalRelief)}</td></tr>`);
            }
            if (result.surchargeMarginalRelief > 0) {
                rows.push(`<tr><td>Marginal Relief (Surcharge)</td><td class="deduction">- ${formatCurrency(result.surchargeMarginalRelief)}</td></tr>`);
            }
            rows.push(`<tr class="total"><td>Total Tax Payable</td><td>${formatCurrency(result.totalTax)}</td></tr>`);

            return rows.join('');
        }

        // Update results
        function updateResults() {
            // Ensure all inputs are non-negative
            const income = Math.max(0, parseFloat(document.getElementById('income').value) || 0);
            const ageGroup = document.getElementById('age').value;
            const sec80c = Math.max(0, parseFloat(document.getElementById('deduction80c').value) || 0);
            const sec80d = Math.max(0, parseFloat(document.getElementById('deduction80d').value) || 0);
            const hra = Math.max(0, parseFloat(document.getElementById('hra').value) || 0);
            const homeLoan = Math.max(0, parseFloat(document.getElementById('homeloan').value) || 0);
            const nps = Math.max(0, parseFloat(document.getElementById('nps').value) || 0);
            const npsEmployer = Math.max(0, parseFloat(document.getElementById('nps_employer').value) || 0);

            // HRA validation warning
            const hraWarning = document.getElementById('hra-warning');
            if (income > 0 && hra > income * 0.5) {
                hraWarning.style.display = 'block';
            } else {
                hraWarning.style.display = 'none';
            }

            const deductions = { sec80c, sec80d, hra, homeLoan, nps, npsEmployer };

            const oldResult = calculateOldRegimeTax(income, deductions, ageGroup);
            const newResult = calculateNewRegimeTax(income);

            // Update tax amounts
            document.getElementById('old-tax').textContent = formatCurrency(oldResult.totalTax);
            document.getElementById('new-tax').textContent = formatCurrency(newResult.totalTax);

            // Update effective rates
            const oldRate = income > 0 ? ((oldResult.totalTax / income) * 100).toFixed(1) : 0;
            const newRate = income > 0 ? ((newResult.totalTax / income) * 100).toFixed(1) : 0;
            document.getElementById('old-rate').textContent = `${oldRate}% effective`;
            document.getElementById('new-rate').textContent = `${newRate}% effective`;

            // Highlight winner
            const oldCard = document.getElementById('old-regime-card');
            const newCard = document.getElementById('new-regime-card');
            oldCard.classList.remove('winner');
            newCard.classList.remove('winner');

            const savingsBox = document.getElementById('savings-box');

            if (income === 0) {
                savingsBox.innerHTML = `
                    <div class="icon">üí°</div>
                    <div class="text">Enter your income to see comparison</div>
                `;
            } else if (oldResult.totalTax < newResult.totalTax) {
                oldCard.classList.add('winner');
                const savings = newResult.totalTax - oldResult.totalTax;
                savingsBox.innerHTML = `
                    <div class="icon">‚úì</div>
                    <div class="text">OLD REGIME saves you</div>
                    <div class="amount">${formatCurrency(savings)}</div>
                `;
            } else if (newResult.totalTax < oldResult.totalTax) {
                newCard.classList.add('winner');
                const savings = oldResult.totalTax - newResult.totalTax;
                savingsBox.innerHTML = `
                    <div class="icon">‚úì</div>
                    <div class="text">NEW REGIME saves you</div>
                    <div class="amount">${formatCurrency(savings)}</div>
                `;
            } else {
                savingsBox.innerHTML = `
                    <div class="icon">‚öñÔ∏è</div>
                    <div class="text">Both regimes result in same tax</div>
                    <div class="amount">${formatCurrency(oldResult.totalTax)}</div>
                `;
            }

            // Update breakdowns
            document.getElementById('old-breakdown').innerHTML = generateOldBreakdown(oldResult);
            document.getElementById('new-breakdown').innerHTML = generateNewBreakdown(newResult);

            // Update take-home salary
            const takehomeSection = document.getElementById('takehome-section');
            if (income > 0) {
                takehomeSection.style.display = 'block';
                
                const oldTakeHomeYearly = income - oldResult.totalTax;
                const oldTakeHomeMonthly = oldTakeHomeYearly / 12;
                const newTakeHomeYearly = income - newResult.totalTax;
                const newTakeHomeMonthly = newTakeHomeYearly / 12;

                document.getElementById('old-monthly').textContent = formatCurrency(oldTakeHomeMonthly) + '/month';
                document.getElementById('old-yearly').textContent = formatCurrency(oldTakeHomeYearly) + '/year';
                document.getElementById('new-monthly').textContent = formatCurrency(newTakeHomeMonthly) + '/month';
                document.getElementById('new-yearly').textContent = formatCurrency(newTakeHomeYearly) + '/year';
            } else {
                takehomeSection.style.display = 'none';
            }
        }

        // Toggle breakdown visibility
        function toggleBreakdown() {
            const breakdown = document.getElementById('breakdown');
            const toggle = document.querySelector('.breakdown-toggle');
            
            if (breakdown.classList.contains('show')) {
                breakdown.classList.remove('show');
                toggle.textContent = 'Show detailed breakdown ‚ñº';
            } else {
                breakdown.classList.add('show');
                toggle.textContent = 'Hide detailed breakdown ‚ñ≤';
            }
        }

        // Add event listeners to all inputs
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', updateResults);
        });

        // Age selector also triggers recalculation
        document.getElementById('age').addEventListener('change', updateResults);

        // Initialize
        updateResults();
    </script>
</body>
</html>
